
#normal_or_historical_nations = yes
namespace = lirgal_happs

#### RUMOURS OF THE SECOND CARAVAN ####
country_event = {
	id = lirgal_happs.1
	title = "lirgal_happs.1.t"
	desc = "lirgal_happs.1.d"
	picture = lirgalcool_eventPicture
	fire_only_once = yes
	trigger = {
		NOT = { exists = A21 }
		owns_or_subject_of = 262
		OR = {
			religion = sakrelism
			religion = etherflame
			religion = aegmerism
			religion = theiosism
		}
		is_year = 1460
		NOT = { is_year = 1650 }
		is_at_war = no
	}
	
	mean_time_to_happen = {
		months = 60
	}

	immediate = { #Gives Meydan the Second Caravan flag so that Lirgal may spawn
		hidden_effect = {
			if = {
				262 = {
					set_province_flag = second_caravan
				}
			}
			every_country = {
				limit = {
					ai = no 
					NOT = { tag = ROOT }
					capital_scope = {
						continent = alteniquia
					}
				}
				country_event = { id = lirgal_happs.100 }
			}
		}
	}
	option = {
			name = "lirgal_happs.1.a"
			custom_tooltip = "lirgal_happs.1.a.tt"
		}

}

country_event = {
	id = lirgal_happs.100
	title = "lirgal_happs.1.t"
	desc = "lirgal_happs.1.d"
	picture = lirgalcool_eventPicture
	is_triggered_only = yes

	trigger = {
		always = yes			
	}

	mean_time_to_happen = {
		days = 1
	}

	option = {
		name = "lirgal_happs.1.a"
		custom_tooltip = "lirgal_happs.1.a.tt"
	}
}


#### LIRGAL FORMS ####
country_event = {
	id = lirgal_happs.201
	title = "lirgal_happs.t.201"
	desc = "lirgal_happs.d.201"
	picture = lirgalcool_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		NOT = { exists = A21 }
		is_at_war = no
		owns_or_subject_of = 262
		if = {
			262 = {
				has_province_flag = second_caravan
			}
		}
	}
	mean_time_to_happen = {
		months = 5
	}
	immediate = {
		hidden_effect = {
			if = { #Yeah, the Lirgalyn settle without asking
				262 = {
					add_core = A21
					change_religion = asitir
					change_culture = lirgalyn
					clr_province_flag =  second_caravan
				}
				755 = {
					add_core = A21
					change_religion = asitir
					change_culture = lirgalyn
				}
				753 = {
					add_core = A21
					change_religion = asitir
					change_culture = lirgalyn
				}
				261 = {
					change_religion = asitir
					change_culture = lirgalyn
				}
				754 = {
					change_religion = asitir
					change_culture = lirgalyn
				}
			}
		}
	}

	option = { #The country is weak and releases Lirgal, gotta input AI decision
		name = "lirgal_happs.2.a"
		trigger = {
			NOT = {
				manpower_percentage = 0.6
				stability = 1
			}
		}
		262 = { change_province_name = "Lirgal" }
		753 = {
			if = {
				limit = { NOT = { owns = ROOT} }
				set_province_flag = lirgal_demands.a
			}
		}
		755 = {
			if = {
				limit = { NOT = { owns = ROOT } }
				set_province_flag = lirgal_demands.b
			}
		}
		release = A21
		A21 = {
			adopt_reform_progress = ROOT
			capital_scope = {
				build_to_forcelimit = {
					infantry = 0.8
					cavalry = 0.1
				}
			}
		}
	}

	option = { #The country is weak and the real player switches to Lirgal
		name = "lirgal_happs.2.b"
		trigger = {
			NOT = {
				manpower_percentage = 0.6
				stability = 1
			}
		}
		262 = { change_province_name = "Lirgal" }
		753 = {
			if = {
				limit = { NOT = { owns = ROOT} }
				set_province_flag = lirgal_demands.a
			}
		}
		755 = {
			if = {
				limit = { NOT = { owns = ROOT } }
				set_province_flag = lirgal_demands.b
			}
		}
		release = A21
		A21 = {
			adopt_reform_progress = ROOT
			capital_scope = {
				build_to_forcelimit = {
					infantry = 0.8
					cavalry = 0.1
				}
			}
		}
		switch_tag = A21
	}

	option = { #The country is strong and releases Lirgal
		name = "lirgal_happs.2.c"
		trigger = {
			OR ={
				manpower_percentage = 0.6
				stability = 1
			}
		}
		262 = { change_province_name = "Lirgal" }
				753 = {
			if = {
				limit = { NOT = { owns = ROOT} }
				set_province_flag = lirgal_demands.a
			}
		}
		755 = {
			if = {
				limit = { NOT = { owns = ROOT } }
				set_province_flag = lirgal_demands.b
			}
		}
		release = A21
		A21 = {
			adopt_reform_progress = ROOT
			capital_scope = {
				build_to_forcelimit = {
					infantry = 0.8
					cavalry = 0.1
				}
			}
		}
	}

	option = { #Country strong, release+switch Lirgal
		name = "lirgal_happs.2.d"
		trigger = {
			OR ={
				manpower_percentage = 0.6
				stability = 1
			}
		}
		262 = { change_province_name = "Lirgal" }
				753 = {
			if = {
				limit = { NOT = { owns = ROOT} }
				set_province_flag = lirgal_demands.a
			}
		}
		755 = {
			if = {
				limit = { NOT = { owns = ROOT } }
				set_province_flag = lirgal_demands.b
			}
		}
		release = A21
		A21 = {
			adopt_reform_progress = ROOT
			capital_scope = {
				build_to_forcelimit = {
					infantry = 0.8
					cavalry = 0.1
				}
			}
		}
		switch_tag = A21
	}

	option = { #Country strong, vassalirgal
		name = "lirgal_happs.2.e"
		trigger = {
			OR ={
				manpower_percentage = 0.6
				stability = 1
			}
		}
		262 = { change_province_name = "Lirgal" }
		753 = {
			if = {
				limit = { NOT = { owns = ROOT} }
				set_province_flag = lirgal_demands.a
			}
		}
		755 = {
			if = {
				limit = { NOT = { owns = ROOT } }
				set_province_flag = lirgal_demands.b
			}
		}
		release = A21
		A21 = {
			adopt_reform_progress = ROOT
			capital_scope = {
				build_to_forcelimit = {
					infantry = 0.8
					cavalry = 0.1
				}
			}
		}
		create_march = A21
	}

	option = { #Country strong, vassalirgal and switch
		name = "lirgal_happs.2.f"
		trigger = {
			OR ={
				manpower_percentage = 0.6
				stability = 1
			}
		}
		262 = { change_province_name = "Lirgal" }
		753 = {
			if = {
				limit = { NOT = { owns = ROOT} }
				set_province_flag = lirgal_demands.a
			}
		}
		755 = {
			if = {
				limit = { NOT = { owns = ROOT } }
				set_province_flag = lirgal_demands.b
			}
		}		
		release = A21
		A21 = {
			adopt_reform_progress = ROOT
			capital_scope = {
				build_to_forcelimit = {
					infantry = 0.8
					cavalry = 0.1
				}
			}
		}
		create_march = A21
		switch_tag = A21
	}

	option = { #Fight the hordes of invading Lirgalyn and protect the Sagaviri land like the good xenophobes they are
		name = "lirgal_happs.2.g"
		trigger = {
			OR = {
				manpower_percentage = 0.6
				stability = 1
			}
		}
		262 = {
			spawn_rebels = {
				size = 2
				type = nationalist_rebels
				culture = lirgalyn
				religion = asitir
				unrest = 2
				separatists_target = A21
				win = yes
			}
			753 = {
				if = {
					limit = { country_or_subject_holds = ROOT }
					spawn_rebels = {
						size = 1
						type = nationalist_rebels
						culture = lirgalyn
						religion = asitir
						unrest = 2
						separatists_target = A21
					}
				}
				else = { set_province_flag = lirgal_demands.a }
			}
			755 = {
				if = {
					limit = { country_or_subject_holds = ROOT }
					spawn_rebels = {
						size = 1
						type = nationalist_rebels
						culture = lirgalyn
						religion = asitir
						unrest = 2
						separatists_target = A21
					}
				}
				else = { set_province_flag = lirgal_demands.b }
			}
		}
	}
}
